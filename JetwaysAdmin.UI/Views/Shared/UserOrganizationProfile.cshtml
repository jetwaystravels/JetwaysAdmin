@using System.Security.Claims;
<!DOCTYPE html>
<html lang="en">
@Html.Partial("Head")
<body>
    <header>
        @Html.Partial("_Loader")
        <div id="pcoded" class="pcoded">
            <div class="pcoded-overlay-box"></div>
            <div class="pcoded-container navbar-wrapper">
                @Html.Partial("_HeaderNav")
                <div class="pcoded-main-container">
                    <div class="pcoded-wrapper">
                        <nav class="pcoded-navbar">
                            <div class="sidebar_toggle"><a href="#"><i class="icon-close icons"></i></a></div>
                            <div class="pcoded-inner-navbar main-menu">
                                <div class="">
                                    <div class="main-menu-header">
                                        <a asp-controller="OrganizationStructure" asp-action="ShowOrganization" asp-route-IdLegal="@ViewBag.LegalEntityId" asp-route-legalentitycode="@ViewBag.LegalEntityCode" asp-route-legalentityname="@ViewBag.LegalEntityName" style="position: relative; z-index: 10;"><i class="fa fa-arrow-left mr-2" aria-hidden="true" style="vertical-align: text-top;"></i></a>
                                        <img class="img-80" title="logo" src="../assets/images/customer-logo/default-logo.png" alt="logo">
                                        <h6 style="font-weight:700;">
                                            @if (ViewBag.LegalEntityName != null)
                                            {
                                                @ViewBag.LegalEntityName
                                            }

                                            @if (ViewBag.LegalEntityCode != null)
                                            {
                                                @("-")  @ViewBag.LegalEntityCode
                                            }
                                            <a href="#" style="color: #0e93d8; display:block; margin-top:12px;">View Org. Structure </a>
                                        </h6>
                                    </div>
                                </div>
                                <ul class="pcoded-item pcoded-left-item">
                                    <!-- USER -->
                                    <li class="pcoded-hasmenu">
                                        <a href="javascript:void(0)" class="waves-effect waves-dark">
                                            <span class="pcoded-micon"><i class="fa fa-user"></i></span>
                                            <span class="pcoded-mtext">User</span>
                                            <span class="pcoded-mcaret"></span>
                                        </a>

                                        <ul class="pcoded-submenu">
                                            <li>
                                            <a asp-controller="Users" asp-action="updateUser" asp-route-UserID="@ViewBag.EUserid"
                                                   asp-route-IdLegal="@ViewBag.LegalEntityId"
                                                   asp-route-legalEntityName="@ViewBag.LegalEntityName"
                                                   asp-route-empId="@ViewBag.empId"
                                                   asp-route-legalEntityCode="@ViewBag.LegalEntityCode"><span class="pcoded-micon"><i class="fa fa-user"></i></span><span class="pcoded-mtext">Personal Info</span></a>
                                            </li>
                                            <li>
                                            <a asp-controller="Users" asp-action="OrganizationUsersProfile" asp-route-UserID="@ViewBag.EUserid"
                                                   asp-route-IdLegal="@ViewBag.LegalEntityId" asp-route-empId="@ViewBag.empId"
                                                   asp-route-legalEntityName="@ViewBag.LegalEntityName"
                                                   asp-route-legalEntityCode="@ViewBag.LegalEntityCode"><span class="pcoded-micon"><i class="fa fa-users"></i></span><span class="pcoded-mtext">Organization Profile</span></a>
                                            </li>
                                            <li><a href="#"><span class="pcoded-micon"><i class="fa fa-users"></i></span><span class="pcoded-mtext">Contact Details</span></a></li>
                                            <li><a href="#"><span class="pcoded-micon"><i class="fa fa-users"></i></span><span class="pcoded-mtext">Documents</span></a></li>
                                            <li><a href="#"><span class="pcoded-micon"><i class="fa fa-envelope-o"></i></span><span class="pcoded-mtext">Preference</span></a></li>
                                            <li><a href="#"><span class="pcoded-micon"><i class="fa fa-envelope-o"></i></span><span class="pcoded-mtext">Credit Cards</span></a></li>
                                            <li><a href="#"><span class="pcoded-micon"><i class="fa fa-envelope-o"></i></span><span class="pcoded-mtext">Family</span></a></li>
                                            <li><a href="#"><span class="pcoded-micon"><i class="fa fa-envelope-o"></i></span><span class="pcoded-mtext">Reporting Parameters</span></a></li>
                                            <li><a href="#"><span class="pcoded-micon"><i class="fa fa-envelope-o"></i></span><span class="pcoded-mtext">GDS Profile</span></a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>
                        </nav>
                        <div class="pcoded-content">
                            <main role="main" class="pb-3">
                                @RenderBody()
                            </main>
                        </div>
                        <div id="styleSelector"> </div>
                    </div>
                </div>
            </div>
            <!-- Main-body end -->
        </div>
    </header>
    @Html.Partial("Footer")

    @await RenderSectionAsync("Scripts", required: false)
    <!-- multiple selection Jquery start -->
    <script>
        $('.langOpt').multiselect({
            columns: 1,
            texts: {
                placeholder: 'Associated Fare Type(s) *'
            }
        });
        $('.langOptone').multiselect({
            columns: 1,
            texts: {
                placeholder: 'Business Travel'
            }
        });

        $('.langOpttwo').multiselect({
            columns: 1,
            texts: {
                placeholder: 'Personal Travel'
            }
        });
    </script>
    <!-- multiple selection Jquery start -->
    <script>
        $(function () {
            $(".select").select2();
        });
        flatpickr(".date-main", {
            dateFormat: "Y-m-d",
            minDate: "today",
            allowInput: true,
            changeMonth: true,
            changeYear: true
        });
    </script>
    <!-- Upload image format start -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const sidebarItems = document.querySelectorAll('.pcoded-navbar .pcoded-item li');
            const currentPath = window.location.pathname.toLowerCase();
            let matched = false;
            sidebarItems.forEach(function (li) {
                const link = li.querySelector('a');
                if (link) {
                    const linkHref = new URL(link.href, window.location.origin).pathname.toLowerCase();

                    if (currentPath === linkHref) {
                        li.classList.add('active');
                        matched = true;
                    } else {
                        li.classList.remove('active');
                    }
                }
            });
            if (!matched && sidebarItems.length > 0) {
                sidebarItems[0].classList.add('active');
            }
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const currentUrl = window.location.pathname.toLowerCase();
            const sidebarLinks = document.querySelectorAll(".pcoded-item a");

            sidebarLinks.forEach(function (link) {
                const linkPath = link.pathname.toLowerCase();
                if (currentUrl === linkPath || currentUrl.startsWith(linkPath)) {
                    link.classList.add("active");
                    const parentLi = link.closest("li.pcoded-hasmenu");
                    if (parentLi) {
                        parentLi.classList.add("pcoded-trigger", "active");
                    }
                    const subLi = link.closest("li");
                    if (subLi) {
                        subLi.classList.add("active");
                    }
                }
            });
        });
    </script>

</body>
</html>
