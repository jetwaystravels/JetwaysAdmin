@model JetwaysAdmin.UI.ViewModel.MenuHeaddata
@{
    Layout = "~/Views/Shared/_LegalEntities.cshtml";
    var Data = Model;
}
<style>
    .alert {
        padding: 5px;
        background-color: #11c15b;
        color: white;
        width:25%;
    }

    .closebtn {
        margin-left: 15px;
        color: white;
        font-weight: bold;
        float: right;
        font-size: 22px;
        line-height: 20px;
        cursor: pointer;
        transition: 0.3s;
    }

  .closebtn:hover {
            color: black;
        }
</style>
<main id="main" class="main">
    <div class="pcoded-main-container">
        <div class="pcoded-wrapper">
            <!-- Page-header start -->
            <div class="page-header">
                <div class="page-block">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <div class="page-header-title">
                                <h5 class="m-b-10">Manage Staff</h5>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item">
                                    <a href="#">Setting</a>
                                </li>
                                <li class="breadcrumb-item">
                                    <a href="#">Manage Customers</a>
                                </li>
                                <li class="breadcrumb-item">
                                    Manage Staff
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="pcoded-inner-content">
                <!-- Main-body start -->
                <div class="main-body">
                    <div class="page-wrapper">
                        <!-- Page-body start -->
                        <div class="page-body">
                            @if(TempData["DataUpdate"] !=null){
                            <div class="alert">
                                <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
                                <strong>Data!</strong> @TempData["DataUpdate"]
                            </div>
                            }
                            <div class="card">
                                <form class="card-block" asp-controller="ManageStaff" asp-action="ManageStaff">
                                    <input type="hidden" name="LegalEntityCode" value="@ViewBag.LegalEntityCode">
                                    <input type="hidden" name="LegalEntityCodeStaf" value="@ViewBag.LegalEntityCode" />
                                    <input type="hidden" name="LegalEntityNameStaf" value="@ViewBag.LegalEntityName" />
                                    <div class="form-group form-primary col-md-3 U-select">
                                        <div class="dropdown" data-field="KeyAccountManager">
                                            <div class="m-b-15" style="font-size:13px;">Key Account Managers</div>
                                            <div class="m-l-10 m-b-10" onclick="toggleDropdown(event)">
                                                <i class="fa fa-user-plus m-r-10" aria-hidden="true" style="color: #0e93d8;"></i> Select Managers
                                            </div>
                                            <div class="selected-items"></div>
                                            <div class="dropdown-list">
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Fc Support</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Satish Bhatti</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Shalini Sharma</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Rahul Gaur</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Amit Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Amit Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Manoj Jha</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Adhar Budhraja</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Yatin Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Sona Shah</div>
                                            </div>
                                            <input type="hidden" name="KeyAccountManager" id="KeyAccountManager" />
                                        </div>
                                    </div>
                                    <div class="m-b-15" style="border-top: 1px solid #dee2e6;"></div>
                                    <div class="form-group form-primary col-md-3 U-select">
                                        <div class="dropdown" data-field="SalesSpoc">
                                            <div class="m-b-15" style="font-size:13px;">Sales Spoc</div>
                                            <div class="m-l-10 m-b-10" onclick="toggleDropdown(event)">
                                                <i class="fa fa-user-plus m-r-10" aria-hidden="true" style="color: #0e93d8;"></i> Assaign Sales Spoc
                                            </div>
                                            <div class="selected-items"></div>
                                            <div class="dropdown-list">
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Fc Support</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Satish Bhatti</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Shalini Sharma</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Rahul Gaur</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Amit Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Amit Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Manoj Jha</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Adhar Budhraja</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Yatin Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Sona Shah</div>
                                            </div>
                                            <input type="hidden" name="SalesSpoc" id="SalesSpoc" />
                                        </div>
                                    </div>
                                    <div class="m-b-15" style="border-top: 1px solid #dee2e6;"></div>
                                    <div class="form-group form-primary col-md-3 U-select">
                                        <div class="dropdown" data-field="BookingConsultant">
                                            <div class="m-b-15" style="font-size:13px;">Booking Consultant(s)</div>
                                            <div class="m-l-10 m-b-10" onclick="toggleDropdown(event)">
                                                <i class="fa fa-user-plus m-r-10" aria-hidden="true" style="color: #0e93d8;"></i> Booking Consultant
                                            </div>
                                            <div class="selected-items"></div>
                                            <div class="dropdown-list">
                                                @foreach (var vny in Model.InternalUsers) 
                                                {
                                                    var fullName = $"{vny.FirstName} {vny.LastName}";
                                                    <div class="dropdown-item" onclick="selectItem(event)"
                                                         data-employee-id="@vny.EmpId" data-user-id="@vny.UserID">
                                                        <img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">
                                                        @vny.UserID-@fullName
                                                    </div>
                                                }
                                            </div>
                                            <input type="hidden" name="BookingConsultant" id="BookingConsultant" />
                                        </div>

                                    </div>
                                    <div class="m-b-15" style="border-top: 1px solid #dee2e6;"></div>
                                    <div class="form-group form-primary col-md-3 U-select">
                                        <div class="dropdown" data-field="EmergencyContact">
                                            <div class="m-b-15" style="font-size:13px;">Emergency Contact Person</div>
                                            <div class="m-l-10 m-b-10" onclick="toggleDropdown(event)">
                                                <i class="fa fa-user-plus m-r-10" aria-hidden="true" style="color: #0e93d8;"></i> Assaign Emergency Contact Person
                                            </div>
                                            <div class="selected-items"></div>
                                            <div class="dropdown-list">
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Fc Support</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Satish Bhatti</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Shalini Sharma</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Rahul Gaur</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Amit Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Amit Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Manoj Jha</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Adhar Budhraja</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Yatin Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Sona Shah</div>
                                            </div>
                                            <input type="hidden" name="EmergencyContact" id="EmergencyContact" />
                                        </div>
                                    </div>
                                    <div class="m-b-15" style="border-top: 1px solid #dee2e6;"></div>
                                    <div class="form-group form-primary col-md-3 U-select">
                                        <div class="dropdown" data-field="UserGroup">
                                            <div class="m-b-15" style="font-size:13px;">User Group</div>
                                            <div class="m-l-10 m-b-10" onclick="toggleDropdown(event)">
                                                <i class="fa fa-user-plus m-r-10" aria-hidden="true" style="color: #0e93d8;"></i> User Group
                                            </div>
                                            <div class="selected-items"></div>
                                            <div class="dropdown-list">
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Fc Support</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Satish Bhatti</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Shalini Sharma</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Rahul Gaur</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Amit Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Amit Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Manoj Jha</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Adhar Budhraja</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Yatin Kumar</div>
                                                <div class="dropdown-item" onclick="selectItem(event)"><img class="m-r-10" loading="lazy" src="../assets/images/login-img.svg" style="height:34px;">Sona Shah</div>
                                            </div>
                                            <input type="hidden" name="UserGroup" id="UserGroup" />
                                        </div>
                                    </div>
                                    <div class="form-group form-primary col-md-12 m-l-5">
                                        <button type="submit" class="btn btn-primary waves-effect waves-light">Update</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Page-body end -->
            </div>
        </div>
    </div>
</main>



<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- multiple selection Jquery start -->
<script>
    $('#langOpt').multiselect({
        columns: 1,
        texts: {
            placeholder: 'Associated Fare Type(s) *'
        }
    });
</script>
<!-- multiple selection Jquery start -->

<script>
    $(function () {
        $(".select").select2();
    });
</script>

<!-- datepicker start -->
<script>
    $(function () {
        $(".date-main").datepicker({
            changeMonth: true,
            changeYear: true
        });
    });
</script>
<!-- datepicker End -->
<!-- Select Users start -->
<script>
    function toggleDropdown(event) {
        event.stopPropagation();
        let dropdown = event.currentTarget.closest('.dropdown').querySelector('.dropdown-list');
        document.querySelectorAll('.dropdown-list').forEach(list => {
            if (list !== dropdown) list.classList.remove('active');
        });
        dropdown.classList.toggle('active');
    }

    function selectItem(event) {
        let item = event.target.innerText.trim();
        let dropdown = event.target.closest('.dropdown');
        let selectedContainer = dropdown.querySelector('.selected-items');
        let field = dropdown.dataset.field;

        if (!selectedContainer.querySelector(`[data-value="${item}"]`)) {
            let itemElem = document.createElement('div');
            itemElem.classList.add('selected-item');
            itemElem.dataset.value = item;
            itemElem.innerHTML = `${item} <span onclick="removeItem(this, '${item}', '${field}')">X</span>`;
            selectedContainer.appendChild(itemElem);
            updateHiddenField(field);
        }
    }

    function removeItem(span, item, field) {
        let dropdown = span.closest('.dropdown');
        let selectedContainer = dropdown.querySelector('.selected-items');

        selectedContainer.querySelectorAll('.selected-item').forEach(elem => {
            if (elem.dataset.value === item) {
                elem.remove();
            }
        });

        updateHiddenField(field);
    }

    function updateHiddenField(field) {
        let dropdown = document.querySelector(`.dropdown[data-field="${field}"]`);
        let selectedValues = Array.from(dropdown.querySelectorAll('.selected-item'))
            .map(item => item.dataset.value)
            .join(',');
        document.getElementById(field).value = selectedValues;
    }
    document.addEventListener('click', function (event) {
        document.querySelectorAll('.dropdown-list').forEach(list => {
            if (!list.closest('.dropdown').contains(event.target)) {
                list.classList.remove('active');
            }
        });
    });

    $(document).ready(function () {
        $('.employee-item').on('click', function () {
            var userId = $(this).data('user-id');
            var name = $(this).text().trim();

            // Set the hidden input value
            $('#BookingConsultant').val(userId);

            // Optional: show selected item
            $('.selected-items').text(name);
        });
    });
</script>
<!-- Select Users End -->